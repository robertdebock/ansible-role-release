---
# tasks file for server
- name: load packages
  include_vars: "{{ ansible_distribution }}-{{ ansible_distribution_major_version }}.yml"

- name: install software (yum)
  yum:
    name: "{{ item }}"
  with_items:
    - "{{ packages }}"
  notify:
    - reboot
    - wait for the machine to be down
    - wait for the machine to be up
  when:
    - ansible_pkg_mgr == "yum"

- name: install software (apt)
  apt:
    name: "{{ item }}"
  with_items:
    - "{{ packages }}"
  notify:
    - reboot
    - wait for the machine to be down
    - wait for the machine to be up
  when:
    - ansible_pkg_mgr == "apt"

- name: install software (package)
  yum:
    name: "{{ item }}"
  with_items:
    - "{{ packages }}"
  notify:
    - reboot
    - wait for the machine to be down
    - wait for the machine to be up
  when:
    - ansible_pkg_mgr != "yum" and ansible_pkg_mgr != "apt"
